<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Lesson 06: Cleaning Data -- Missing and Bad Data Values &#8211; NEON/ Data Carpentry Intro to Spatio-Temporal Data and Data Management Best Practices</title>
<meta name="description" content="This tutorial covers spatial data cleaning - specifically dealing with missing (NA / NAN) values and bad values when working with spatial data in R.">
<meta name="keywords" content="R, GIS-Spatial-Data, informatics">


<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Lesson 06: Cleaning Data -- Missing and Bad Data Values">
<meta property="og:description" content="This tutorial covers spatial data cleaning - specifically dealing with missing (NA / NAN) values and bad values when working with spatial data in R.">
<meta property="og:url" content="http://localhost:4000/R/EditLink">
<meta property="og:site_name" content="NEON/ Data Carpentry Intro to Spatio-Temporal Data and Data Management Best Practices">





<link rel="canonical" href="http://localhost:4000/R/EditLink">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="NEON/ Data Carpentry Intro to Spatio-Temporal Data and Data Management Best Practices Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google Webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>
<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.min.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="http://localhost:4000/assets/js/vendor/html5shiv.min.js"></script>
	<script src="http://localhost:4000/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">


<link rel="stylesheet" href="/assets/highlightjs/styles/zenburn.css">
<script src="/assets/highlightjs/highlight.packR.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
<div class="NEON-header">
<img src="/images/banners/header_whole.png" alt="NEON" style="width:100%;">
</div>
	<div class="site-name">
		<a href="http://localhost:4000">NEON/ Data Carpentry Intro to Spatio-Temporal Data and Data Management Best Practices</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				<li><a href="http://localhost:4000/about/" >About</a></li>
		        
				<li><a href="http://www.neoninc.org" target="_blank">NEON Website</a></li>
		        
				<li><a href="http://www.datacarpentry.org" target="_blank">Data Carpentry Website</a></li>
		        
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->


  <div class="image-wrap">
  <img src=
    
      "http://localhost:4000/images/banners/NEONCarpentryHeader_2.png"
    
  alt="Lesson 06: Cleaning Data -- Missing and Bad Data Values feature image">
    <span class="image-credit">Source: 
     
    A collaboration between the National Ecological Observatory Network (NEON) and Data Carpentry 
    
    </span>
  </div><!-- /.image-wrap -->




<div id="main" role="main">
  <div class="article-author-side">

    

	 <img src="http://localhost:4000/images/profilePic.png" class="bio-photo" alt="NEON / Data Carpentry Hackathon bio photo"></a>



<h3>NEON / Data Carpentry Hackathon</h3>
<p>Devoted to open data and open source in science and education.</p>


<h3>Activities By Topic</h3>


  
    
  
    
  
    
   
      (7) 
     </a></h5>


  
    
  
    
  
    
   
      (7) 
     </a></h5>


  
    
  
    
  
    
   
      (6) 
     </a></h5>


  
    
  
    
  
    
   
      (1) 
     </a></h5>


  
    
  
    
  
    
   
      (1) 
     </a></h5>
 

<!--
<h4><a href="/activities/">View ALL Activities</a></h4>
<h4><a href="/activities-by-tag/">Activities by Tag</a></h4>

-->
<br><br><br>









<a href="http://github.com/data-lessons" class="author-social" target="_blank"><i class="fa fa-github"></i> Github</a>







<br><br><br>


  </div>
  <article>
    <div class="headline-wrap">
      
        <h1><a href="http://localhost:4000/R/EditLink" rel="bookmark" title="Lesson 06: Cleaning Data -- Missing and Bad Data Values">Lesson 06: Cleaning Data -- Missing and Bad Data Values</a></h1>
      
    </div><!--/ .headline-wrap -->

    <div class="article-wrap">
    <!-- List authors at the top of the lesson -->
    <span class="post-date">
    Authors: <br>
    
    Reviewers: 
       
     </span>
      <section id="table-of-contents" class="toc">
  <header>
    <h3><i class="fa fa-book"></i> Overview</h3>
  </header>
<div id="drawer">
<ul id="markdown-toc">
  <li><a href="#goals--objectives" id="markdown-toc-goals--objectives">Goals / Objectives</a></li>
</ul>

  </div>
</section>
<!-- /#table-of-contents -->

<h2 id="about">About</h2>
<p>Add description.</p>

<p><strong>R Skill Level:</strong> Intermediate - you’ve got the basics of <code>R</code> down.</p>

<div id="objectives">

  <h1 id="goals--objectives">Goals / Objectives</h1>

  <p>After completing this activity, you will:</p>

  <ul>
    <li></li>
  </ul>

  <h2 id="things-youll-need-to-complete-this-lesson">Things You’ll Need To Complete This Lesson</h2>
  <p>To complete this lesson you will need the most current version of R, and 
preferably, RStudio loaded on your computer.</p>

  <h3 id="install-r-packages">Install R Packages</h3>

  <ul>
    <li>
      <p><strong>NAME:</strong> <code>install.packages("NAME")</code></p>
    </li>
    <li>
      <p><a href="R/Packages-In-R/">More on Packages in R - Adapted from Software Carpentry.</a></p>
    </li>
  </ul>

  <h3 id="download-data">Download Data</h3>
  <p>EDIT AS NEEDED
<a href="https://ndownloader.figshare.com/files/3648519" class="btn btn-success"> Download NEON Teaching Data Subset: Airborne Remote Sensing Data</a></p>

  <p>The LiDAR and imagery data used to create this raster teaching data subset 
were collected over the 
<a href="http://www.neoninc.org/" target="_blank"> National Ecological Observatory Network's</a> 
<a href="http://www.neoninc.org/science-design/field-sites/harvard-forest" target="_blank">Harvard Forest</a>
and 
<a href="http://www.neoninc.org/science-design/field-sites/san-joaquin-experimental-range" target="_blank">San Joaquin Experimental Range</a>
field sites and processed at
<a href="http://www.neoninc.org" target="_blank">NEON headquarters.</a> 
The entire dataset can be accessed by request from the 
<a href="http://www.neoninc.org/data-resources/get-data/airborne-data" target="_blank"> NEON Airborne Data Request Page </a> on the NEON website.
</p>

  <hr />

  <p><strong>Set Working Directory:</strong> This lesson assumes that you have set your working 
directory to the location of the downloaded and unzipped data subsets. <a href="/R/Set-Working-Directory" title="R Working Directory Lesson">An overview
of setting the working directory in <code>R</code> can be found here.</a>.</p>

  <p><strong>R Script &amp; Challenge Code:</strong> NEON data lessons often contain challenges that reinforce 
learned skills. If available, the code for challenge solutions is found in the
downloadable <code>R</code> script of the entire lesson, available in the footer of each lesson page.</p>

  <p><strong>Spatial-Temporal Data &amp; Data Management Lesson Series:</strong> This lesson is part
of a lesson series introducing
<a href="tutorial/URL">spatial data and data management in <code>R</code> </a>.
It is also part of a larger 
<a href="workshops/spatio-temporal-workshop">spatio-temporal Data Carpentry Workshop </a>
that includes working with<br />
<a href="tutorial/spatial-raster-series">raster data in <code>R</code> </a>,
<a href="tutorial/spatial-vector-series">vector data in <code>R</code> </a>
and<br />
<a href="tutorial/tabular-time-series">tabular time series in <code>R</code> </a>.</p>

  <hr />

  <h3 id="additional-resources">Additional Resources</h3>

  <ul>
    <li><a href="http://cran.r-project.org/web/packages/raster/raster.pdf" target="_blank">
Read more about the <code>raster</code> package in <code>R</code>.</a></li>
    <li><a href="http://neondataskills.org/R/Raster-Data-In-R/" target="_blank">
NEON Data Skills: Raster Data in R - The Basics</a></li>
    <li><a href="http://neondataskills.org/R/Image-Raster-Data-In-R/" target="_blank">
NEON Data Skills: Image Raster Data in R - An Intro</a></li>
  </ul>

</div>

<h3 id="clean-data">Clean Data</h3>
<p>No dataset is perfect. It is common to encounter large files containing obviously
erronious data (bad data).  It is also common to encounter <code>NoData</code>
values that we need to account for when analyzing our data.</p>

<h2 id="nodata-values-na-nan">NoData Values (NA, NAN)</h2>
<p>If we are lucky when working with external data, the <code>NoData</code> value is clearly
specified in the metadata. Sometimes this value is <code>NA</code> or <code>nan</code> (not a number). However, 
<code>NA</code> isn’t always used. Text values can make data storage difficult for some 
programs and thus, sometimes you’ll encounter a large negative value such as
<code>-9999</code> used as the <code>NoData</code> value. At other times, we might see blank values in
a data file which designate <code>NoData</code>. Blanks are particularly problematic
because we can’t be certain if a data value is purposefully missing (not
measured that day or a bad measurement) or if someone unintentionally deleted
it.</p>

<p class="notice"><i class="fa fa-star"></i> <strong>Data Tip:</strong><code>-9999</code> is a common value used in
both the remote sensing field and the atmospheric fields. It is also
the standard used by the <a href="http://www.neoninc.org" target="_blank"> 
National Ecological Observatory Network (NEON)</a>.</p>

<p>Because the actual value used to designate missing data can vary depending upon 
what data we are working with, it is important to always check the metadata for
the files associated <code>NoData</code> value. If the value is <code>NA</code>, we are in luck, <code>R</code>
will recognize and flag this value as <code>NoData</code>. If the value is numeric (e.g.,
<code>-9999</code>),then we might need to assign this value to <code>NA</code>.</p>

<p class="notice"><i class="fa fa-star"></i> <strong>Data Tip:</strong> <code>NA</code> values will be ignored when
performing calculations in <code>R</code>. However a <code>NoData</code> value of <code>-9999</code> will be
recognized as an integer and processed accordingly. If you encounter a numeric
<code>NoData</code> value be sure to assign it to <code>NA</code> in <code>R</code>:
<code>objectName[objectName==-9999] &lt;- NA</code></p>

<h3 id="check-for-na-values">Check for NA values</h3>
<p>We can quickly check for <code>NoData</code> values in our data using the<code>is.na()</code> 
function. By asking for the <code>sum()</code> of <code>is.na()</code> we can see how many NA/ missing
values we have.</p>

<p>REPLACE CODE TO BE FOR THE SAME SMALLISH DATA SET USED FOR BAD DATA VALUES BELOW</p>

<pre><code>#Check for NA values
sum(is.na(harMet15.09.11$datetime))

## Error in eval(expr, envir, enclos): object 'harMet15.09.11' not found

sum(is.na(harMet15.09.11$airt))

## Error in eval(expr, envir, enclos): object 'harMet15.09.11' not found

#view rows where the air temperature is NA 
harMet15.09.11[is.na(harMet15.09.11$airt),]

## Error in eval(expr, envir, enclos): object 'harMet15.09.11' not found
</code></pre>

<p>The results above tell us there are <code>NoData</code> values in the <code>datetime</code> column.
However, there are <code>NoData</code> values in other variables.</p>

<h3 id="deal-with-nodata-values">Deal with NoData Values</h3>
<p>When we encounter <code>NoData</code> values (blank, NaN, -9999, etc.) in our data we
need to decide how to deal with them. By default <code>R</code> treats <code>NoData</code> values
designated
with a <code>NA</code> as a missing value rather than a zero. This is good, as a value of 
zero (no rain today) is not the same as missing data (e.g. we didn’t measure the 
amount of rainfall today).</p>

<p>How we deal with <code>NoData</code> values will depend on:</p>

<ul>
  <li>the data type we are working with</li>
  <li>the analysis we are conducting</li>
  <li>the significance of the gap or missing value</li>
</ul>

<p>Sometimes we might need to “gap fill” our data. This means we will interpolate 
or estimate missing values often using statistical methods. Gap filling can be 
complex and is beyond the scope of this lesson. The take away from this lessons
is simply that it is important to acknowledge missing values in your data and to 
carefully consider how you wish to account for them during analysis.</p>

<p>Other resources:</p>

<ol>
  <li><a href="http://www.statmethods.net/input/missingdata.html" target="_blank"> Quick-R: Missing Data</a> 
– R code for dealing with missing data</li>
  <li>The Institute for Digital Research and Education has an <a href="http://www.ats.ucla.edu/stat/r/faq/missing.htm" target="_blank"> R FAQ on Missing Values</a>.</li>
</ol>

<h2 id="bad-data-values">Bad Data Values</h2>
<p>Bad data values are different from <code>NoDataValue</code>. Bad data values are values that
fall outside of the applicable range of a dataset. 
Examples of Bad Data Values:</p>

<ul>
  <li>The normalized difference vegetation index (NDVI), which is a measure of 
greenness, has a valid range of -1 to 1. Any value outside of that range would 
be considered a “bad” or miscalculated value.</li>
  <li>If we are using a Julian day (0-365/366) to represent the days of the year. A value
of 1110 is clearly not correct.</li>
</ul>

<h3 id="find-bad-data-values">Find Bad Data Values</h3>
<p>Sometimes a dataset’s metadata will tell us the range of expected values for a
variable or common sense dictates the expected value (as in the Julian day example above).
Values outside of this range are suspect and we need to consider than
when we analyze the data. Sometimes, we need to use some common sense and
scientific insight as we examine the data - just as we would for field data t
identify questionable values.</p>

<p>We can explore the distribution of values contained within our data using the 
<code>hist</code> function which produces a histogram. Histograms are often useful in 
identifying outliers and bad data values in our raster data.</p>

<p>HIST of SMALLISH DATA SET WITH SOME OUTLANDISH VALUE</p>

<h3 id="deal-with-bad-data-values">Deal with Bad Data Values</h3>





<!-- The code directly below is required to generate tags and categories at the page bottom-->



<!-- This code generates the category link at the bottom of the page-->

		
            
                
            
                
            
                
            
            
        

        
            
            
                
                    
                
                    
                
                    
                
                
            
                
                    
                
                    
                
                    
                
                
            
                
                    
                
                    
                
                    
                
                
            
        

<!-- remove the stuff above if the site slows down - this is to populate tags -->


      <hr />
      

<div id="relatedCode">
<h2>Get Lesson Code</h2>
(some browsers may require you to right click.)
<ul>
	<li>
 	<a href="/code/06-clean-data-bad-and-missing-values.R" class="btn btn-info"> 06-clean-data-bad-and-missing-values.R </a> </li>

	
</ul>
</div>

      <footer role="contentinfo">
        <div class="article-author-bottom">
          

	 <img src="http://localhost:4000/images/profilePic.png" class="bio-photo" alt="NEON / Data Carpentry Hackathon bio photo"></a>



<h3>NEON / Data Carpentry Hackathon</h3>
<p>Devoted to open data and open source in science and education.</p>


<h3>Activities By Topic</h3>


  
    
  
    
  
    
   
      (7) 
     </a></h5>


  
    
  
    
  
    
   
      (7) 
     </a></h5>


  
    
  
    
  
    
   
      (6) 
     </a></h5>


  
    
  
    
  
    
   
      (1) 
     </a></h5>


  
    
  
    
  
    
   
      (1) 
     </a></h5>
 

<!--
<h4><a href="/activities/">View ALL Activities</a></h4>
<h4><a href="/activities-by-tag/">Activities by Tag</a></h4>

-->
<br><br><br>









<a href="http://github.com/data-lessons" class="author-social" target="_blank"><i class="fa fa-github"></i> Github</a>







<br><br><br>

        </div>
        <p class="byline id="post-meta"><strong>Lesson 06: Cleaning Data -- Missing and Bad Data Values</strong> was  with <i class="fa fa-tags"></i>: 
       on <time datetime="2015-10-24T00:00:00-06:00">October 24, 2015</time> 
       <!--by .  Contributors: Huge thanks to <strong> </strong> for input and feedback!  --> 
       <a href="http://localhost:4000/about" title="About NEON / Data Carpentry Hackathon">About NEON / Data Carpentry Hackathon</a>.</p>
      </footer>


    <!-- /.article-wrap -->

  

  </div>
  </article>
</div><!-- /#main -->



<div class="footer-wrap">
  <div class="related-articles">
  <!-- <h4>You might also enjoy <small class="pull-right">(<a href="http://localhost:4000/posts/">View all activities</a>)</small></h4> -->
<h2><a>Related Content: spatial-data-management-series</a></h2>

    

    

    

    

    

    

    

    

  </div><!-- /.related-articles -->
  <footer>
    <span>&copy; 2016 National Ecological Observatory Network (NEON) -- Boulder, Colorado. <a href="http://www.neoninc.org" target=_blank></a>
We love feedback! Email: neondataskills at neoninc.org or tweet @leahawasser .

<p>Powered by <a href="http://jekyllrb.com">Jekyll</a> A huge shout out to creator of the <a href="http://mademistakes.com/minimal-mistakes/">Minimal Mistakes</a> theme.</p></span>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-52746937-1', 'auto');
  ga('send', 'pageview');

</script>
  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>



</body>
</html>
